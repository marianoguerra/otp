<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../otp_doc.css" type="text/css">
<title>Erlang -- Applications</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<div class="erlang-logo-wrapper"><img alt="Erlang Logo" src="../erlang-logo.png" class="erlang-logo"></div>
<p class="section-title">OTP Design Principles</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 8.1</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="../pdf/otp-system-documentation-8.1.pdf">PDF</a></li>
<li><a href="../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3>Chapters</h3>
<ul class="flipMenu" imagepath="../js/flipmenu">
<li id="no" title="Overview" expanded="false">Overview<ul>
<li><a href="des_princ.html">
              Top of chapter
            </a></li>
<li title="Supervision Trees"><a href="des_princ.html#idm45578011683488">Supervision Trees</a></li>
<li title="Behaviours"><a href="des_princ.html#idm45578011690992">Behaviours</a></li>
<li title="Applications"><a href="des_princ.html#idm45578011735584">Applications</a></li>
<li title="Releases"><a href="des_princ.html#idm45578011741904">Releases</a></li>
<li title="Release Handling"><a href="des_princ.html#idm45578011745216">Release Handling</a></li>
</ul>
</li>
<li id="no" title="gen_server Behaviour" expanded="false">gen_server Behaviour<ul>
<li><a href="gen_server_concepts.html">
              Top of chapter
            </a></li>
<li title="Client-Server Principles"><a href="gen_server_concepts.html#idm45578011605600">Client-Server Principles</a></li>
<li title="Example"><a href="gen_server_concepts.html#idm45578011609024">Example</a></li>
<li title="Starting a Gen_Server"><a href="gen_server_concepts.html#idm45578011615680">Starting a Gen_Server</a></li>
<li title="Synchronous Requests - Call"><a href="gen_server_concepts.html#idm45578012143648">Synchronous Requests - Call</a></li>
<li title="Asynchronous Requests - Cast"><a href="gen_server_concepts.html#idm45578011582096">Asynchronous Requests - Cast</a></li>
<li title="Stopping"><a href="gen_server_concepts.html#idm45578011583280">Stopping</a></li>
<li title="Handling Other Messages"><a href="gen_server_concepts.html#idm45578011934192">Handling Other Messages</a></li>
</ul>
</li>
<li id="no" title="gen_fsm Behaviour" expanded="false">gen_fsm Behaviour<ul>
<li><a href="fsm.html">
              Top of chapter
            </a></li>
<li title="Finite-State Machines"><a href="fsm.html#idm45578012636944">Finite-State Machines</a></li>
<li title="Example"><a href="fsm.html#idm45578012638128">Example</a></li>
<li title="Starting gen_fsm"><a href="fsm.html#idm45578012482032">Starting gen_fsm</a></li>
<li title="Notifying about Events"><a href="fsm.html#idm45578013071264">Notifying about Events</a></li>
<li title="Time-Outs"><a href="fsm.html#idm45578013414448">Time-Outs</a></li>
<li title="All State Events"><a href="fsm.html#idm45578011831440">All State Events</a></li>
<li title="Stopping"><a href="fsm.html#idm45578011686000">Stopping</a></li>
<li title="Handling Other Messages"><a href="fsm.html#idm45578011693712">Handling Other Messages</a></li>
</ul>
</li>
<li id="no" title="gen_statem Behavior" expanded="false">gen_statem Behavior<ul>
<li><a href="statem.html">
              Top of chapter
            </a></li>
<li title="Event-Driven State Machines"><a href="statem.html#idm45578011351888">Event-Driven State Machines</a></li>
<li title="Callback Modes"><a href="statem.html#idm45578011588800">Callback Modes</a></li>
<li title="State Enter Calls"><a href="statem.html#idm45578011230272">State Enter Calls</a></li>
<li title="Actions"><a href="statem.html#idm45578011225424">Actions</a></li>
<li title="Event Types"><a href="statem.html#idm45578011205936">Event Types</a></li>
<li title="Example"><a href="statem.html#idm45578011187584">Example</a></li>
<li title="Starting gen_statem"><a href="statem.html#idm45578013548496">Starting gen_statem</a></li>
<li title="Handling Events"><a href="statem.html#idm45578011169072">Handling Events</a></li>
<li title="State Time-Outs"><a href="statem.html#idm45578011154048">State Time-Outs</a></li>
<li title="All State Events"><a href="statem.html#idm45578011148336">All State Events</a></li>
<li title="One Event Handler"><a href="statem.html#idm45578011141664">One Event Handler</a></li>
<li title="Stopping"><a href="statem.html#idm45578011136912">Stopping</a></li>
<li title="Event Time-Outs"><a href="statem.html#idm45578011119568">Event Time-Outs</a></li>
<li title="Erlang Timers"><a href="statem.html#idm45578011110080">Erlang Timers</a></li>
<li title="Postponing Events"><a href="statem.html#idm45578011098224">Postponing Events</a></li>
<li title="State Entry Actions"><a href="statem.html#idm45578011074800">State Entry Actions</a></li>
<li title="Self-Generated Events"><a href="statem.html#idm45578011067344">Self-Generated Events</a></li>
<li title="Example Revisited"><a href="statem.html#idm45578011055552">Example Revisited</a></li>
<li title="Filter the State"><a href="statem.html#idm45578011039616">Filter the State</a></li>
<li title="Complex State"><a href="statem.html#idm45578011030080">Complex State</a></li>
<li title="Hibernation"><a href="statem.html#idm45578011010672">Hibernation</a></li>
</ul>
</li>
<li id="no" title="gen_event Behaviour" expanded="false">gen_event Behaviour<ul>
<li><a href="events.html">
              Top of chapter
            </a></li>
<li title="Event Handling Principles"><a href="events.html#idm45578010989632">Event Handling Principles</a></li>
<li title="Example"><a href="events.html#idm45578010983376">Example</a></li>
<li title="Starting an Event Manager"><a href="events.html#idm45578010978400">Starting an Event Manager</a></li>
<li title="Adding an Event Handler"><a href="events.html#idm45578010971360">Adding an Event Handler</a></li>
<li title="Notifying about Events"><a href="events.html#idm45578010960864">Notifying about Events</a></li>
<li title="Deleting an Event Handler"><a href="events.html#idm45578010952368">Deleting an Event Handler</a></li>
<li title="Stopping"><a href="events.html#idm45578010942944">Stopping</a></li>
<li title="Handling Other Messages"><a href="events.html#idm45578010936416">Handling Other Messages</a></li>
</ul>
</li>
<li id="no" title="Supervisor Behaviour" expanded="false">Supervisor Behaviour<ul>
<li><a href="sup_princ.html">
              Top of chapter
            </a></li>
<li title="Supervision Principles"><a href="sup_princ.html#idm45578010923536">Supervision Principles</a></li>
<li title="Example"><a href="sup_princ.html#idm45578010920640">Example</a></li>
<li title="Supervisor Flags"><a href="sup_princ.html#idm45578010911968">Supervisor Flags</a></li>
<li title="Restart Strategy"><a href="sup_princ.html#idm45578010904032">Restart Strategy</a></li>
<li title="Maximum Restart Intensity"><a href="sup_princ.html#idm45578010888960">Maximum Restart Intensity</a></li>
<li title="Child Specification"><a href="sup_princ.html#idm45578010879808">Child Specification</a></li>
<li title="Starting a Supervisor"><a href="sup_princ.html#idm45578010826976">Starting a Supervisor</a></li>
<li title="Adding a Child Process"><a href="sup_princ.html#idm45578010812976">Adding a Child Process</a></li>
<li title="Stopping a Child Process"><a href="sup_princ.html#idm45578010807712">Stopping a Child Process</a></li>
<li title="Simplified one_for_one Supervisors"><a href="sup_princ.html#idm45578010800720">Simplified one_for_one Supervisors</a></li>
<li title="Stopping"><a href="sup_princ.html#idm45578010785360">Stopping</a></li>
</ul>
</li>
<li id="no" title="sys and proc_lib" expanded="false">sys and proc_lib<ul>
<li><a href="spec_proc.html">
              Top of chapter
            </a></li>
<li title="Simple Debugging"><a href="spec_proc.html#idm45578010773536">Simple Debugging</a></li>
<li title="Special Processes"><a href="spec_proc.html#idm45578010763440">Special Processes</a></li>
<li title="User-Defined Behaviours"><a href="spec_proc.html#idm45578010688144">User-Defined Behaviours</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Applications" expanded="true">Applications<ul>
<li><a href="applications.html">
              Top of chapter
            </a></li>
<li title="Application Concept"><a href="applications.html#idm45578010651936">Application Concept</a></li>
<li title="Application Callback Module"><a href="applications.html#idm45578010643872">Application Callback Module</a></li>
<li title="Application Resource File"><a href="applications.html#idm45578010628800">Application Resource File</a></li>
<li title="Directory Structure"><a href="applications.html#idm45578010598448">Directory Structure</a></li>
<li title="Application Controller"><a href="applications.html#idm45578010587168">Application Controller</a></li>
<li title="Loading and Unloading Applications"><a href="applications.html#idm45578010583200">Loading and Unloading Applications</a></li>
<li title="Starting and Stopping Applications"><a href="applications.html#idm45578010575744">Starting and Stopping Applications</a></li>
<li title="Configuring an Application"><a href="applications.html#idm45578010565232">Configuring an Application</a></li>
<li title="Application Start Types"><a href="applications.html#idm45578010540256">Application Start Types</a></li>
</ul>
</li>
<li id="no" title="Included Applications" expanded="false">Included Applications<ul>
<li><a href="included_applications.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="included_applications.html#idm45578010522960">Introduction</a></li>
<li title="Specifying Included Applications"><a href="included_applications.html#idm45578010515104">Specifying Included Applications</a></li>
<li title="Synchronizing Processes during Startup"><a href="included_applications.html#idm45578010512064">Synchronizing Processes during Startup</a></li>
</ul>
</li>
<li id="no" title="Distributed Applications" expanded="false">Distributed Applications<ul>
<li><a href="distributed_applications.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="distributed_applications.html#idm45578010483952">Introduction</a></li>
<li title="Specifying Distributed Applications"><a href="distributed_applications.html#idm45578010479648">Specifying Distributed Applications</a></li>
<li title="Starting and Stopping Distributed Applications"><a href="distributed_applications.html#idm45578010455968">Starting and Stopping Distributed Applications</a></li>
<li title="Failover"><a href="distributed_applications.html#idm45578010443280">Failover</a></li>
<li title="Takeover"><a href="distributed_applications.html#idm45578010425600">Takeover</a></li>
</ul>
</li>
<li id="no" title="Releases" expanded="false">Releases<ul>
<li><a href="release_structure.html">
              Top of chapter
            </a></li>
<li title="Release Concept"><a href="release_structure.html#idm45578010401072">Release Concept</a></li>
<li title="Release Resource File"><a href="release_structure.html#idm45578010394784">Release Resource File</a></li>
<li title="Generating Boot Scripts"><a href="release_structure.html#idm45578010377680">Generating Boot Scripts</a></li>
<li title="Creating a Release Package"><a href="release_structure.html#idm45578010364848">Creating a Release Package</a></li>
<li title="Directory Structure"><a href="release_structure.html#idm45578010344832">Directory Structure</a></li>
</ul>
</li>
<li id="no" title="Release Handling" expanded="false">Release Handling<ul>
<li><a href="release_handling.html">
              Top of chapter
            </a></li>
<li title="Release Handling Principles"><a href="release_handling.html#idm45578010315584">Release Handling Principles</a></li>
<li title="Requirements"><a href="release_handling.html#idm45578010284896">Requirements</a></li>
<li title="Distributed Systems"><a href="release_handling.html#idm45578010274176">Distributed Systems</a></li>
<li title="Release Handling Instructions"><a href="release_handling.html#idm45578010271024">Release Handling Instructions</a></li>
<li title="Application Upgrade File"><a href="release_handling.html#idm45578010203552">Application Upgrade File</a></li>
<li title="Release Upgrade File"><a href="release_handling.html#idm45578010180000">Release Upgrade File</a></li>
<li title="Installing a Release"><a href="release_handling.html#idm45578010161056">Installing a Release</a></li>
<li title="Updating Application Specifications"><a href="release_handling.html#idm45578010100880">Updating Application Specifications</a></li>
</ul>
</li>
<li id="no" title="Appup Cookbook" expanded="false">Appup Cookbook<ul>
<li><a href="appup_cookbook.html">
              Top of chapter
            </a></li>
<li title="Changing a Functional Module"><a href="appup_cookbook.html#idm45578010076960">Changing a Functional Module</a></li>
<li title="Changing a Residence Module"><a href="appup_cookbook.html#idm45578010074672">Changing a Residence Module</a></li>
<li title="Changing a Callback Module"><a href="appup_cookbook.html#idm45578010069568">Changing a Callback Module</a></li>
<li title="Changing Internal State"><a href="appup_cookbook.html#idm45578010063136">Changing Internal State</a></li>
<li title="Module Dependencies"><a href="appup_cookbook.html#idm45578010045824">Module Dependencies</a></li>
<li title="Changing Code for a Special Process"><a href="appup_cookbook.html#idm45578010024896">Changing Code for a Special Process</a></li>
<li title="Changing a Supervisor"><a href="appup_cookbook.html#idm45578010003056">Changing a Supervisor</a></li>
<li title="Adding or Deleting a Module"><a href="appup_cookbook.html#idm45578009972208">Adding or Deleting a Module</a></li>
<li title="Starting or Terminating a Process"><a href="appup_cookbook.html#idm45578009968880">Starting or Terminating a Process</a></li>
<li title="Adding or Removing an Application"><a href="appup_cookbook.html#idm45578009966640">Adding or Removing an Application</a></li>
<li title="Restarting an Application"><a href="appup_cookbook.html#idm45578009962960">Restarting an Application</a></li>
<li title="Changing an Application Specification"><a href="appup_cookbook.html#idm45578009957600">Changing an Application Specification</a></li>
<li title="Changing Application Configuration"><a href="appup_cookbook.html#idm45578009954752">Changing Application Configuration</a></li>
<li title="Changing Included Applications"><a href="appup_cookbook.html#idm45578009951424">Changing Included Applications</a></li>
<li title="Changing Non-Erlang Code"><a href="appup_cookbook.html#idm45578009919968">Changing Non-Erlang Code</a></li>
<li title="Emulator Restart and Upgrade"><a href="appup_cookbook.html#idm45578009908240">Emulator Restart and Upgrade</a></li>
<li title="Emulator Upgrade From Pre OTP R15"><a href="appup_cookbook.html#idm45578009898000">Emulator Upgrade From Pre OTP R15</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>8 Applications</h1>
  
  <a name="appl"></a>
  <p>This section is to be read with the <span class="code">app(4)</span> and
  <span class="code">application(3)</span> manual pages in Kernel.</p>

  <h3><a name="idm45578010651936">8.1 
        Application Concept</a></h3>
    
    <p>When you have written code implementing some specific functionality
      you might want to make the code into an <strong>application</strong>,
      that is, a component that can be started and stopped as a unit,
      and which can also be reused in other systems.</p>
    <p>To do this, create an
      <span class="bold_code"><a href="#callback_module">application callback module</a></span>,
      and describe how the application is to be started and stopped.</p>
    <p>Then, an <strong>application specification</strong> is needed, which is
      put in an
      <span class="bold_code"><a href="#appl_res_file">application resource file</a></span>.
      Among other things, this file specifies which modules the application
      consists of and the name of the callback module.</p>
    <p>If you use <span class="code">systools</span>, the Erlang/OTP tools for packaging code
      (see <span class="bold_code"><a href="release_structure.html">Releases</a></span>),
      the code for each application is placed in a
      separate directory following a pre-defined
    <span class="bold_code"><a href="#app_dir">directory structure</a></span>.</p>
  

  <h3>
<a name="callback_module"></a><a name="idm45578010643872">8.2 
        Application Callback Module</a>
</h3>
    
    
    <p>How to start and stop the code for the application, that is,
      the supervision tree, is described by two callback functions:</p>
    <div class="example"><pre>
start(StartType, StartArgs) -&gt; {ok, Pid} | {ok, Pid, State}
stop(State)
    </pre></div>
    <ul>
      <li>
<span class="code">start</span> is called when starting the application and is to
      create the supervision tree by starting the top supervisor. It is
      expected to return the pid of the top supervisor and an optional
      term, <span class="code">State</span>, which defaults to <span class="code">[]</span>. This term is passed
      as is to <span class="code">stop</span>.</li>
      <li>
<span class="code">StartType</span> is usually the atom <span class="code">normal</span>. It has other
      values only in the case of a takeover or failover, see
      <span class="bold_code"><a href="distributed_applications.html">Distributed Applications</a></span>.
      </li>
      <li>
<span class="code">StartArgs</span> is defined by the key <span class="code">mod</span> in the
      <span class="bold_code"><a href="#appl_res_file">application resource file</a></span>.</li>
      <li>
<span class="code">stop/1</span> is called <strong>after</strong> the application has been
      stopped and is to do any necessary cleaning up. The actual stopping of
      the application, that is, the shutdown of the supervision tree, is
      handled automatically as described in
      <span class="bold_code"><a href="#stopping">Starting and Stopping Applications</a></span>.
      </li>
    </ul>
    <a name="ch_app"></a>
    <p>Example of an application callback module for packaging
      the supervision tree from
      <span class="bold_code"><a href="sup_princ.html#ex">Supervisor Behaviour</a></span>:</p>
    <div class="example"><pre>
-module(ch_app).
-behaviour(application).

-export([start/2, stop/1]).

start(_Type, _Args) -&gt;
    ch_sup:start_link().

stop(_State) -&gt;
    ok.</pre></div>
    <p>A library application that cannot be started or stopped, does not
      need any application callback module.</p>
  

  <h3>
<a name="appl_res_file"></a><a name="idm45578010628800">8.3 
        Application Resource File</a>
</h3>
    
    
    <p>To define an application, an <strong>application specification</strong> is
      created, which is put in an <strong>application resource file</strong>, or in
      short an <span class="code">.app</span> file:</p>
    <div class="example"><pre>
{application, Application, [Opt1,...,OptN]}.</pre></div>
<ul>
    <li>
<span class="code">Application</span>, an atom, is the name of the application.
      The file must be named <span class="code">Application.app</span>.</li>
    <li>Each <span class="code">Opt</span> is a tuple <span class="code">{Key,Value}</span>, which define a
      certain property of the application. All keys are optional.
      Default values are used for any omitted keys.</li>
</ul>
    <p>The contents of a minimal <span class="code">.app</span> file for a library
      application <span class="code">libapp</span> looks as follows:</p>
    <div class="example"><pre>
{application, libapp, []}.</pre></div>
    <p>The contents of a minimal <span class="code">.app</span> file <span class="code">ch_app.app</span> for
      a supervision tree application like <span class="code">ch_app</span> looks as follows:</p>
    <div class="example"><pre>
{application, ch_app,
 [{mod, {ch_app,[]}}]}.</pre></div>
    <p>The key <span class="code">mod</span> defines the callback module and start argument of
      the application, in this case <span class="code">ch_app</span> and <span class="code">[]</span>, respectively.
      This means that the following is called when the application is to be
      started:</p>
    <div class="example"><pre>
ch_app:start(normal, [])</pre></div>
    <p>The following is called when the application is stopped.</p>
    <div class="example"><pre>
ch_app:stop([])</pre></div>
    <p>When using <span class="code">systools</span>, the Erlang/OTP tools for packaging
      code (see Section
      <span class="bold_code"><a href="release_structure.html">Releases</a></span>), the keys
      <span class="code">description</span>, <span class="code">vsn</span>, <span class="code">modules</span>, <span class="code">registered</span>,
      and <span class="code">applications</span> are also to be specified:</p>
    <div class="example"><pre>
{application, ch_app,
 [{description, "Channel allocator"},
  {vsn, "1"},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}}
 ]}.</pre></div>
 <ul>
   <li>
<span class="code">description</span> - A short description, a string. Defaults to
   "".</li>
   <li>
<span class="code">vsn</span> - Version number, a string. Defaults to "".</li>
   <li>
<span class="code">modules</span> - All modules <strong>introduced</strong> by this
   application. <span class="code">systools</span> uses this list when generating boot scripts
   and tar files. A module must be defined in only one application.
   Defaults to <span class="code">[]</span>.</li>
   <li>
<span class="code">registered</span> - All names of registered processes in the
   application. <span class="code">systools</span> uses this list to detect name clashes
   between applications. Defaults to <span class="code">[]</span>.</li>
   <li>
<span class="code">applications</span> - All applications that must be
   started before this application is started. <span class="code">systools</span> uses this
   list to generate correct boot scripts. Defaults to <span class="code">[]</span>. Notice
   that all applications have dependencies to at least Kernel
   and STDLIB.</li>
 </ul>
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>For details about the syntax and contents of the application
    resource file, see the <span class="bold_code"><a href="javascript:erlhref('../../','kernel','app.html');">app</a></span>
    manual page in Kernel.</p></p></div>
</div>
  

  <h3>
<a name="app_dir"></a><a name="idm45578010598448">8.4 
        Directory Structure</a>
</h3>
    
    
    <p>When packaging code using <span class="code">systools</span>, the code for each
      application is placed in a separate directory,
      <span class="code">lib/Application-Vsn</span>, where <span class="code">Vsn</span> is the version number.</p>
    <p>This can be useful to know, even if <span class="code">systools</span> is not used,
      since Erlang/OTP is packaged according to the OTP principles
      and thus comes with this directory structure. The code server
      (see the <span class="code">code(3)</span> manual page in Kernel) automatically
      uses code from
      the directory with the highest version number, if more than one
      version of an application is present.</p>
    <p>The application directory structure can also be used in the
      development environment. The version number can then
      be omitted from the name.</p>
    <p>The application directory has the following sub-directories:</p>
    <ul>
      <li>
<span class="code">src</span> - Contains the Erlang source code.</li>
      <li>
<span class="code">ebin</span> - Contains the Erlang object code, the
      <span class="code">beam</span> files. The <span class="code">.app</span> file is also placed here.</li>
      <li>
<span class="code">priv</span> - Used for application specific files. For
      example, C executables are placed here. The function
      <span class="code">code:priv_dir/1</span> is to be used to access this directory.</li>
      <li>
<span class="code">include</span> - Used for include files.</li>
    </ul>
  

  <h3>
<a name="application_controller"></a><a name="idm45578010587168">8.5 
        Application Controller</a>
</h3>
    
    
    <p>When an Erlang runtime system is started, a number of processes
      are started as part of the Kernel application. One of these
      processes is the <strong>application controller</strong> process,
      registered as <span class="code">application_controller</span>.</p>
    <p>All operations on applications are coordinated by the application
      controller. It is interacted through the functions in
      the module <span class="code">application</span>, see the <span class="code">application(3)</span>
      manual page in Kernel. In particular, applications can be
      loaded, unloaded, started, and stopped.</p>
  

  <h3><a name="idm45578010583200">8.6 
        Loading and Unloading Applications</a></h3>
    
    <p>Before an application can be started, it must be <strong>loaded</strong>.
      The application controller reads and stores the information from
      the <span class="code">.app</span> file:</p>
    <div class="example"><pre>
1&gt; <span class="bold_code">application:load(ch_app).</span>
ok
2&gt; <span class="bold_code">application:loaded_applications().</span>
[{kernel,"ERTS  CXC 138 10","2.8.1.3"},
 {stdlib,"ERTS  CXC 138 10","1.11.4.3"},
 {ch_app,"Channel allocator","1"}]</pre></div>
    <p>An application that has been stopped, or has never been started,
      can be unloaded. The information about the application is
      erased from the internal database of the application controller.</p>
    <div class="example"><pre>
3&gt; <span class="bold_code">application:unload(ch_app).</span>
ok
4&gt; <span class="bold_code">application:loaded_applications().</span>
[{kernel,"ERTS  CXC 138 10","2.8.1.3"},
 {stdlib,"ERTS  CXC 138 10","1.11.4.3"}]</pre></div>
    <div class="note">
<div class="label">Note</div>
<div class="content"><p>
      <p>Loading/unloading an application does not load/unload the code
      used by the application. Code loading is done the usual way.</p>
    </p></div>
</div>
  

  <h3>
<a name="stopping"></a><a name="idm45578010575744">8.7 
        Starting and Stopping Applications</a>
</h3>
    
    
    <p>An application is started by calling:</p>
    <div class="example"><pre>
5&gt; <span class="bold_code">application:start(ch_app).</span>
ok
6&gt; <span class="bold_code">application:which_applications().</span>
[{kernel,"ERTS  CXC 138 10","2.8.1.3"},
 {stdlib,"ERTS  CXC 138 10","1.11.4.3"},
 {ch_app,"Channel allocator","1"}]</pre></div>
    <p>If the application is not already loaded, the application
      controller first loads it using <span class="code">application:load/1</span>. It
      checks the value of the <span class="code">applications</span> key, to ensure
      that all applications that are to be started before this
      application are running.</p>
    <a name="application_master"></a>
    <p>The application controller then creates an
    <strong>application master</strong> for the application. The application master
      is the group leader of all the processes in the application.
      The application master starts the application by calling
      the application callback function <span class="code">start/2</span> in the module,
      and with the start argument, defined by the <span class="code">mod</span> key in
      the <span class="code">.app</span> file.</p>
    <p>An application is stopped, but not unloaded, by calling:</p>
    <div class="example"><pre>
7&gt; <span class="bold_code">application:stop(ch_app).</span>
ok</pre></div>
    <p>The application master stops the application by telling the top
      supervisor to shut down. The top supervisor tells all its child
      processes to shut down, and so on; the entire tree is terminated in
      reversed start order. The application master then calls
      the application callback function <span class="code">stop/1</span> in the module
      defined by the <span class="code">mod</span> key.</p>
  

  <h3><a name="idm45578010565232">8.8 
        Configuring an Application</a></h3>
    
    <p>An application can be configured using
    <strong>configuration parameters</strong>. These are a list of
    <span class="code">{Par,Val}</span> tuples
    specified by a key <span class="code">env</span> in the <span class="code">.app</span> file:</p>
    <div class="example"><pre>
{application, ch_app,
 [{description, "Channel allocator"},
  {vsn, "1"},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}},
  {env, [{file, "/usr/local/log"}]}
 ]}.</pre></div>
    <p><span class="code">Par</span> is to be an atom. <span class="code">Val</span> is any term.
      The application can retrieve the value of a configuration
      parameter by calling <span class="code">application:get_env(App, Par)</span> or a
      number of similar functions, see the <span class="code">application(3)</span>
      manual page in Kernel.</p>
    <p><strong>Example:</strong></p>
    <div class="example"><pre>
% <span class="bold_code">erl</span>
Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; <span class="bold_code">application:start(ch_app).</span>
ok
2&gt; <span class="bold_code">application:get_env(ch_app, file).</span>
{ok,"/usr/local/log"}</pre></div>
    <p>The values in the <span class="code">.app</span> file can be overridden by values
      in a <strong>system configuration file</strong>. This is a file that
      contains configuration parameters for relevant applications:</p>
    <div class="example"><pre>
[{Application1, [{Par11,Val11},...]},
 ...,
 {ApplicationN, [{ParN1,ValN1},...]}].</pre></div>
    <p>The system configuration is to be called <span class="code">Name.config</span> and
      Erlang is to be started with the command-line argument
      <span class="code">-config Name</span>. For details, see the <span class="code">config(4)</span>
      manual page in Kernel.</p>
    <p><strong>Example:</strong></p>
    <p>A file <span class="code">test.config</span> is created with the following contents:</p>
    <div class="example"><pre>
[{ch_app, [{file, "testlog"}]}].</pre></div>
    <p>The value of <span class="code">file</span> overrides the value of <span class="code">file</span>
      as defined in the <span class="code">.app</span> file:</p>
    <div class="example"><pre>
% <span class="bold_code">erl -config test</span>
Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; <span class="bold_code">application:start(ch_app).</span>
ok
2&gt; <span class="bold_code">application:get_env(ch_app, file).</span>
{ok,"testlog"}</pre></div>
    <p>If
      <span class="bold_code"><a href="release_handling.html#sys">release handling</a></span>
      is used, exactly one system configuration file is to be used and
      that file is to be called <span class="code">sys.config</span>.</p>
    <p>The values in the <span class="code">.app</span> file and the values in a
      system configuration file can be overridden directly from
      the command line:</p>
    <div class="example"><pre>
% <span class="bold_code">erl -ApplName Par1 Val1 ... ParN ValN</span></pre></div>
    <p><strong>Example:</strong></p>
    <div class="example"><pre>
% <span class="bold_code">erl -ch_app file '"testlog"'</span>
Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; <span class="bold_code">application:start(ch_app).</span>
ok
2&gt; <span class="bold_code">application:get_env(ch_app, file).</span>
{ok,"testlog"}</pre></div>
  

  <h3><a name="idm45578010540256">8.9 
        Application Start Types</a></h3>
    
    <p>A <strong>start type</strong> is defined when starting the application:</p>
    <div class="example"><pre>
application:start(Application, Type)</pre></div>
    <p><span class="code">application:start(Application)</span> is the same as calling
      <span class="code">application:start(Application, temporary)</span>. The type can
      also be <span class="code">permanent</span> or <span class="code">transient</span>:</p>
    <ul>
      <li>If a permanent application terminates, all other
       applications and the runtime system are also terminated.</li>
      <li>If a transient application terminates with reason
      <span class="code">normal</span>, this is reported but no other applications are
       terminated. If a transient application terminates abnormally,
       that is with any other reason than <span class="code">normal</span>, all other
       applications and the runtime system are also terminated.</li>
      <li>If a temporary application terminates, this is reported but
       no other applications are terminated.</li>
    </ul>
    <p>An application can always be stopped explicitly by
      calling <span class="code">application:stop/1</span>. Regardless of the mode, no
      other applications are affected.</p>
    <p>The transient mode is of little practical use, since when
      a supervision tree terminates, the reason is set to
      <span class="code">shutdown</span>, not <span class="code">normal</span>.</p>
  
</div>
<div class="footer">
<hr>
<p>Copyright © 1997-2016 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div></body>
</html>
